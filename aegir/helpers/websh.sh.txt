#!/bin/bash

export PATH=$PATH:/opt/local/bin

_ALL="$@"
### echo _ALL is ${_ALL}

if [[ ! "${_ALL}" =~ "composer " ]] \
  && [[ ! "${_ALL}" =~ "drush8 @" ]] \
  && [[ ! "${_ALL}" =~ "drush @" ]] \
  && [[ ! "${_ALL}" =~ "sql-cli" ]] \
  && [[ ! "${_ALL}" =~ "sqlc" ]] \
  && [[ ! "${_ALL}" =~ "sql-connect" ]] \
  && [[ ! "${_ALL}" =~ "sql-dump" ]] \
  && [[ ! "${_ALL}" =~ "sql-query" ]] \
  && [[ ! "${_ALL}" =~ "sqlq" ]] \
  && [[ ! "${_ALL}" =~ "sql-sync" ]]; then
  _ARR=
  if [[ "${_ALL}" =~ "true COLUMNS=" ]]; then
    if [[ "${_ALL}" =~ "-c set -m" ]]; then
      _R_M=`echo -n ${_ALL} | grep -o "\-c set -m\; true COLUMNS=[0-9]\+ drush"`
    else
      _R_M=`echo -n ${_ALL} | grep -o "\-c true COLUMNS=[0-9]\+ drush"`
    fi
    ### echo _R_M is ${_R_M}
    _CLR=`echo ${_ALL} | sed "s/\${_R_M}//g"`
    _ARR=() # the buffer array for filtered parameters
    for arg in "${_CLR}"; do
      case ${_R_M} in
        $arg\ * | *\ $arg | *\ $arg\ *) ;;
        *) _ARR+=("$arg") ;;
      esac
    done
    ### echo _ARR is ${_ARR}
  elif [[ "${_ALL}" =~ "drush " ]]; then
    if [[ "${_ALL}" =~ "-c set -m" ]]; then
      _R_M=`echo -n ${_ALL} | grep -o "\-c set -m\; drush"`
    elif [[ "${_ALL}" =~ "-c drush" ]]; then
      _R_M=`echo -n ${_ALL} | grep -o "\-c drush"`
    else
      _R_M=`echo -n ${_ALL} | grep -o "drush"`
    fi
    ### echo _R_M is ${_R_M}
    _CLR=`echo ${_ALL} | sed "s/\${_R_M}//g"`
    _ARR=() # the buffer array for filtered parameters
    for arg in "${_CLR}"; do
      case ${_R_M} in
        $arg\ * | *\ $arg | *\ $arg\ *) ;;
        *) _ARR+=("$arg") ;;
      esac
    done
    ### echo _ARR is ${_ARR}
  elif [[ "${_ALL}" =~ "drush8 " ]]; then
    if [[ "${_ALL}" =~ "-c set -m" ]]; then
      _R_M=`echo -n ${_ALL} | grep -o "\-c set -m\; drush8"`
    elif [[ "${_ALL}" =~ "-c drush8" ]]; then
      _R_M=`echo -n ${_ALL} | grep -o "\-c drush8"`
    else
      _R_M=`echo -n ${_ALL} | grep -o "drush8"`
    fi
    ### echo _R_M is ${_R_M}
    _CLR=`echo ${_ALL} | sed "s/\${_R_M}//g"`
    _ARR=() # the buffer array for filtered parameters
    for arg in "${_CLR}"; do
      case ${_R_M} in
        $arg\ * | *\ $arg | *\ $arg\ *) ;;
        *) _ARR+=("$arg") ;;
      esac
    done
    ### echo _ARR is ${_ARR}
  elif [[ "${_ALL}" =~ "drush10-bin " ]]; then
    if [[ "${_ALL}" =~ "-c set -m" ]]; then
      _R_M=`echo -n ${_ALL} | grep -o "\-c set -m\; drush10-bin"`
    elif [[ "${_ALL}" =~ "-c drush10-bin" ]]; then
      _R_M=`echo -n ${_ALL} | grep -o "\-c drush10-bin"`
    else
      _R_M=`echo -n ${_ALL} | grep -o "drush10-bin"`
    fi
    ### echo _R_M is ${_R_M}
    _CLR=`echo ${_ALL} | sed "s/\${_R_M}//g"`
    _ARR=() # the buffer array for filtered parameters
    for arg in "${_CLR}"; do
      case ${_R_M} in
        $arg\ * | *\ $arg | *\ $arg\ *) ;;
        *) _ARR+=("$arg") ;;
      esac
    done
    ### echo _ARR is ${_ARR}
  elif [[ "${_ALL}" =~ "drush11-bin " ]]; then
    if [[ "${_ALL}" =~ "-c set -m" ]]; then
      _R_M=`echo -n ${_ALL} | grep -o "\-c set -m\; drush11-bin"`
    elif [[ "${_ALL}" =~ "-c drush11-bin " ]]; then
      _R_M=`echo -n ${_ALL} | grep -o "\-c drush11-bin"`
    else
      _R_M=`echo -n ${_ALL} | grep -o "drush11-bin"`
    fi
    ### echo _R_M is ${_R_M}
    _CLR=`echo ${_ALL} | sed "s/\${_R_M}//g"`
    _ARR=() # the buffer array for filtered parameters
    for arg in "${_CLR}"; do
      case ${_R_M} in
        $arg\ * | *\ $arg | *\ $arg\ *) ;;
        *) _ARR+=("$arg") ;;
      esac
    done
    ### echo _ARR is ${_ARR}
  elif [[ "${_ALL}" =~ "drush12-bin " ]]; then
    if [[ "${_ALL}" =~ "-c set -m" ]]; then
      _R_M=`echo -n ${_ALL} | grep -o "\-c set -m\; drush12-bin"`
    elif [[ "${_ALL}" =~ "-c drush12-bin " ]]; then
      _R_M=`echo -n ${_ALL} | grep -o "\-c drush12-bin"`
    else
      _R_M=`echo -n ${_ALL} | grep -o "drush12-bin"`
    fi
    ### echo _R_M is ${_R_M}
    _CLR=`echo ${_ALL} | sed "s/\${_R_M}//g"`
    _ARR=() # the buffer array for filtered parameters
    for arg in "${_CLR}"; do
      case ${_R_M} in
        $arg\ * | *\ $arg | *\ $arg\ *) ;;
        *) _ARR+=("$arg") ;;
      esac
    done
    ### echo _ARR is ${_ARR}
  fi
fi

_LNCHR_PHP_ARR=
if [[ "${_ALL}" =~ "drushlr " ]]; then
  if [[ "${_ALL}" =~ "-c set -m" ]]; then
    _R_M=`echo -n ${_ALL} | grep -o "\-c set -m\; drushlr"`
  elif [[ "${_ALL}" =~ "-c drushlr " ]]; then
    _R_M=`echo -n ${_ALL} | grep -o "\-c drushlr"`
  else
    _R_M=`echo -n ${_ALL} | grep -o "drushlr"`
  fi
  ### echo _R_M is ${_R_M}
  _CLR=`echo ${_ALL} | sed "s/\${_R_M}//g"`
  _LNCHR_PHP_ARR=() # the buffer array for filtered parameters
  for arg in "${_CLR}"; do
    case ${_R_M} in
      $arg\ * | *\ $arg | *\ $arg\ *) ;;
      *) _LNCHR_PHP_ARR+=("$arg") ;;
    esac
  done
  ### echo _LNCHR_PHP_ARR is ${_LNCHR_PHP_ARR}
fi

_LNCHR_SH_ARR=
if [[ "${_ALL}" =~ "/opt/tools/drush/8/drush/drush.launcher " ]]; then
  if [[ "${_ALL}" =~ "-c set -m" ]]; then
    _R_M=`echo -n ${_ALL} | grep -o "\-c set -m\; /opt/tools/drush/8/drush/drush.launcher"`
  elif [[ "${_ALL}" =~ "-c /opt/tools/drush/8/drush/drush.launcher" ]]; then
    _R_M=`echo -n ${_ALL} | grep -o "\-c /opt/tools/drush/8/drush/drush.launcher"`
  else
    _R_M=`echo -n ${_ALL} | grep -o "/opt/tools/drush/8/drush/drush.launcher"`
  fi
  ### echo _R_M is ${_R_M}
  _CLR=`echo ${_ALL} | sed "s/.*drush.launcher//g"`
  _LNCHR_SH_ARR=() # the buffer array for filtered parameters
  for arg in "${_CLR}"; do
    case ${_R_M} in
      $arg\ * | *\ $arg | *\ $arg\ *) ;;
      *) _LNCHR_SH_ARR+=("$arg") ;;
    esac
  done
  ### echo _LNCHR_SH_ARR is ${_LNCHR_SH_ARR}
fi

_C_ARR=
if [[ "${_ALL}" =~ "composer " ]]; then
  if [[ "${_ALL}" =~ "-c set -m" ]]; then
    _C_RM=`echo -n ${_ALL} | grep -o "\-c set -m\; composer"`
  elif [[ "${_ALL}" =~ "-c composer " ]]; then
    _C_RM=`echo -n ${_ALL} | grep -o "\-c composer"`
  else
    _C_RM=`echo -n ${_ALL} | grep -o "composer"`
  fi
  ### echo _C_RM is ${_C_RM}
  _CLR=`echo ${_ALL} | sed "s/\${_C_RM}//g"`
  _C_ARR=() # the buffer array for filtered parameters
  for arg in "${_CLR}"; do
    case ${_C_RM} in
      $arg\ * | *\ $arg | *\ $arg\ *) ;;
      *) _C_ARR+=("$arg") ;;
    esac
  done
  ### echo _C_ARR is ${_C_ARR}
fi

_INTERNAL=NO
_LTD_GID=$(id -nG ${USER} 2>&1)
_LTD_UID=$(id -nu ${USER} 2>&1)
if [ -z "${USER}" ]; then
  USER=$(id -nu ${USER} 2>&1)
  _LTD_QQQ=YES
fi
_X_USR=".*"
if [ "${USER}" = "aegir" ] \
  || [ "${HOME}" = "/var/aegir" ]; then
  _Y_USR=aegir
  _DRUSH_CLI_CTRL="/var/aegir/static/control/drcr-php-cli"
  ### echo _DRUSH_CLI_CTRL is ${_DRUSH_CLI_CTRL}
else
  _Y_USR=${USER%${_X_USR}}
  _DRUSH_CLI_CTRL="/data/disk/${_Y_USR}/static/control/drcr-php-cli"
  ### echo _DRUSH_CLI_CTRL is ${_DRUSH_CLI_CTRL}
fi
if [ -z "${HOME}" ]; then
  if [ -d "/home/${USER}/.tmp" ]; then
    HOME="/home/${USER}"
  elif [ -d "/data/disk/${_Y_USR}/.tmp" ]; then
    HOME="/data/disk/${_Y_USR}"
  elif [ -d "/var/${_Y_USR}/.tmp" ]; then
    HOME="/var/${_Y_USR}"
  fi
fi
if [ "${1}" = "-c" ] || [[ "${1}" =~ "drush.launcher" ]]; then
  _ARGS="${2}"
else
  _ARGS="${1}"
fi

if [[ "${_ARGS}" =~ "true COLUMNS=" ]]; then
  _R_M=`echo -n "${_ARGS}" | grep -o "true COLUMNS=[0-9]\+ "`
  _ARGS=`echo ${_ARGS} | sed "s/\${_R_M}//g"`
fi

if [[ "${_ARR}" =~ "-c " ]]; then
  _R_M=`echo -n "${_ARR}" | grep -o "\-c "`
  _ARR=`echo ${_ARR} | sed "s/\${_R_M}//g"`
fi

if [ -d "/home/${USER}/.tmp" ]; then
  export TMP="/home/${USER}/.tmp"
  export TMPDIR="/home/${USER}/.tmp"
  export TEMP="/home/${USER}/.tmp"
  if [[ "${_ARGS}" =~ " id " ]] \
    || [[ "${_ARGS}" =~ (^)"id " ]]; then
    exit 1
  elif [[ "${_ARGS}" =~ (^)"newrelic" ]] \
    || [[ "${_ARGS}" =~ (^)"nrsysm" ]]; then
    exit 1
  fi
elif [ -d "/data/disk/${_Y_USR}/.tmp" ]; then
  export TMP="/data/disk/${_Y_USR}/.tmp"
  export TMPDIR="/data/disk/${_Y_USR}/.tmp"
  export TEMP="/data/disk/${_Y_USR}/.tmp"
elif [ -d "/var/${_Y_USR}/.tmp" ]; then
  export TMP="/var/${_Y_USR}/.tmp"
  export TMPDIR="/var/${_Y_USR}/.tmp"
  export TEMP="/var/${_Y_USR}/.tmp"
else
  export TMP="/tmp"
  export TMPDIR="/tmp"
  export TEMP="/tmp"
fi

export HOME=${HOME}
export TEMP=${TEMP}
export USER=${USER}

### echo HOME is ${HOME}
### echo TEMP is ${TEMP}
### echo USER is ${USER}
#
### echo _ALL is ${_ALL}
### echo _ARGS is ${_ARGS}
### echo _LTD_GID is ${_LTD_GID}
### echo _LTD_QQQ is ${_LTD_QQQ}
### echo _LTD_UID is ${_LTD_UID}
### echo _Y_USR is ${_Y_USR}
#
### echo 0 is $0
### echo 1 is $1
### echo 2 is $2
### echo 3 is $3
### echo 4 is $4
### echo 5 is $5
### echo 6 is $6
### echo 7 is $7
### echo 8 is $8
### echo 9 is $9

# Check PHP CLI version defined.
check_php_cli_version() {
  if [ "${HOME}" = "/var/aegir" ]; then
    _PHP_CLI=$(grep "/opt/php" /var/aegir/drush/drush.php 2>&1)
  elif [[ "${HOME}" =~ "/data/disk/" ]]; then
    _PHP_CLI=$(grep "/opt/php" /data/disk/${_Y_USR}/tools/drush/drush.php 2>&1)
  else
    if [ -f "/data/disk/${_Y_USR}/tools/drush/drush.php" ]; then
      _PHP_CLI=$(grep "/opt/php" /data/disk/${_Y_USR}/tools/drush/drush.php 2>&1)
    fi
  fi
  if [[ "${_PHP_CLI}" =~ "php82" ]]; then
    DRUSH_PHP="/opt/php82/bin/php"
    PHP_INI="/opt/php82/lib/php.ini"
  elif [[ "${_PHP_CLI}" =~ "php81" ]]; then
    DRUSH_PHP="/opt/php81/bin/php"
    PHP_INI="/opt/php81/lib/php.ini"
  elif [[ "${_PHP_CLI}" =~ "php80" ]]; then
    DRUSH_PHP="/opt/php80/bin/php"
    PHP_INI="/opt/php80/lib/php.ini"
  elif [[ "${_PHP_CLI}" =~ "php74" ]]; then
    DRUSH_PHP="/opt/php74/bin/php"
    PHP_INI="/opt/php74/lib/php.ini"
  elif [[ "${_PHP_CLI}" =~ "php73" ]]; then
    DRUSH_PHP="/opt/php73/bin/php"
    PHP_INI="/opt/php73/lib/php.ini"
  elif [[ "${_PHP_CLI}" =~ "php72" ]]; then
    DRUSH_PHP="/opt/php72/bin/php"
    PHP_INI="/opt/php72/lib/php.ini"
  elif [[ "${_PHP_CLI}" =~ "php71" ]]; then
    DRUSH_PHP="/opt/php71/bin/php"
    PHP_INI="/opt/php71/lib/php.ini"
  elif [[ "${_PHP_CLI}" =~ "php70" ]]; then
    DRUSH_PHP="/opt/php70/bin/php"
    PHP_INI="/opt/php70/lib/php.ini"
  elif [[ "${_PHP_CLI}" =~ "php56" ]]; then
    DRUSH_PHP="/opt/php56/bin/php"
    PHP_INI="/opt/php56/lib/php.ini"
  else
    DRUSH_PHP="/usr/bin/php"
  fi
  if [ -f "${HOME}/.drush/php.ini" ]; then
    PHP_INI="${HOME}/.drush/php.ini"
    ### echo 1 drush/php.ini PHP_INI is ${PHP_INI}
  fi
  if [ ! -z "${PHP_OPTIONS}" ] && [ -f "${HOME}/.drush/rphp.ini" ]; then
    PHP_INI="${HOME}/.drush/rphp.ini"
    ### echo 1 drush/rphp.ini PHP_OPTIONS is ${PHP_OPTIONS}
    ### echo 1 drush/rphp.ini PHP_INI is ${PHP_INI}
  fi
  export DRUSH_PHP;export PHP_INI;
}

if [ ! -z "${_C_ARR}" ] \
  || [ ! -z "${_ARR}" ] \
  || [ ! -z "${_LNCHR_PHP_ARR}" ] \
  || [ ! -z "${_LNCHR_SH_ARR}" ] ; then
  if [ ! -e "${_DRUSH_CLI_CTRL}/php82.info" ] \
    && [ ! -e "${_DRUSH_CLI_CTRL}/php81.info" ] \
    && [ ! -e "${_DRUSH_CLI_CTRL}/php80.info" ] \
    && [ ! -e "${_DRUSH_CLI_CTRL}/php74.info" ] \
    && [ ! -e "${_DRUSH_CLI_CTRL}/php73.info" ] \
    && [ ! -e "${_DRUSH_CLI_CTRL}/php72.info" ] \
    && [ ! -e "${_DRUSH_CLI_CTRL}/php71.info" ] \
    && [ ! -e "${_DRUSH_CLI_CTRL}/php70.info" ] \
    && [ ! -e "${_DRUSH_CLI_CTRL}/php56.info" ]; then
    check_php_cli_version
  fi
fi

if [ "${_LTD_GID}" = "www-data users" ] \
  || [[ "${HOME}" =~ (^)"/var/aegir" ]] \
  || [[ "${HOME}" =~ (^)"/data/disk/" ]] \
  || [[ "${_LTD_GID}" =~ "lshellg"($) ]] \
  || [[ "${_LTD_GID}" =~ "lshellg rvm"($) ]] \
  || [[ "${_LTD_GID}" =~ "ltd-shell"($) ]] \
  || [[ "${_LTD_GID}" =~ "ltd-shell rvm"($) ]] \
  || [[ "${_LTD_GID}" =~ "rvm ltd-shell"($) ]] \
  || [[ "${_LTD_GID}" =~ (^)"users www-data"($) ]] \
  || [[ "${_LTD_GID}" =~ (^)"aegir www-data users"($) ]]; then
  if [ "${1}" = "-c" ] || [[ "${1}" =~ "drush.launcher" ]]; then
    _ARGS="${2}"
    _IS_SH_PATH=NO
    if [ "$0" = "/bin/sh" ] || [ "$0" = "/usr/bin/sh" ]; then
      _IS_SH_PATH=YES
    else
      echo
      echo "  ERROR: Not Authorized Path"
      echo
      exit 1
    fi
    if [[ "${2}" =~ "set -m;" ]] || [[ "${2}" =~ "drush8 @" ]] || [[ "${1}" =~ "drush.launcher" ]]; then
      _IN_PATH=YES
      _INTERNAL=YES
      if [[ "${_ALL}" =~ "drush " ]] \
        || [[ "${_ALL}" =~ "drush8 " ]] \
        || [[ "${_ALL}" =~ "drushlr " ]] \
        || [[ "${_ALL}" =~ "drush.launcher " ]] \
        || [[ "${_ALL}" =~ "drush10-bin " ]] \
        || [[ "${_ALL}" =~ "drush11-bin " ]] \
        || [[ "${_ALL}" =~ "drush12-bin " ]]; then
        _PWD=$(pwd 2>&1)
        _DEST_DRUSH="/opt/tools/drush/8/drush/drush.php"
        if [[ "${_ALL}" =~ "drush.launcher " ]]; then
          _DEST_DRUSH="/opt/tools/drush/8/drush/drush.php"
          if [ -e "${_DRUSH_CLI_CTRL}/php82.info" ] \
            && [ -x "/opt/php82/bin/php" ]; then
            DRUSH_PHP="/opt/php82/bin/php"
            PHP_INI="/opt/php82/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          elif [ -e "${_DRUSH_CLI_CTRL}/php81.info" ] \
            && [ -x "/opt/php81/bin/php" ]; then
            DRUSH_PHP="/opt/php81/bin/php"
            PHP_INI="/opt/php81/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          elif [ -e "${_DRUSH_CLI_CTRL}/php80.info" ] \
            && [ -x "/opt/php80/bin/php" ]; then
            DRUSH_PHP="/opt/php80/bin/php"
            PHP_INI="/opt/php80/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          elif [ -e "${_DRUSH_CLI_CTRL}/php74.info" ] \
            && [ -x "/opt/php74/bin/php" ]; then
            DRUSH_PHP="/opt/php74/bin/php"
            PHP_INI="/opt/php74/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          elif [ -e "${_DRUSH_CLI_CTRL}/php73.info" ] \
            && [ -x "/opt/php73/bin/php" ]; then
            DRUSH_PHP="/opt/php73/bin/php"
            PHP_INI="/opt/php73/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          elif [ -e "${_DRUSH_CLI_CTRL}/php72.info" ] \
            && [ -x "/opt/php72/bin/php" ]; then
            DRUSH_PHP="/opt/php72/bin/php"
            PHP_INI="/opt/php72/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          elif [ -e "${_DRUSH_CLI_CTRL}/php71.info" ] \
            && [ -x "/opt/php71/bin/php" ]; then
            DRUSH_PHP="/opt/php71/bin/php"
            PHP_INI="/opt/php71/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          elif [ -e "${_DRUSH_CLI_CTRL}/php70.info" ] \
            && [ -x "/opt/php70/bin/php" ]; then
            DRUSH_PHP="/opt/php70/bin/php"
            PHP_INI="/opt/php70/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          elif [ -e "${_DRUSH_CLI_CTRL}/php56.info" ] \
            && [ -x "/opt/php56/bin/php" ]; then
            DRUSH_PHP="/opt/php56/bin/php"
            PHP_INI="/opt/php56/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          fi
        elif [[ "${_ALL}" =~ "drushlr " ]]; then
          _DEST_DRUSH="/usr/bin/drushlr"
          if [ -e "${_DRUSH_CLI_CTRL}/php82.info" ] \
            && [ -x "/opt/php82/bin/php" ]; then
            DRUSH_PHP="/opt/php82/bin/php"
            PHP_INI="/opt/php82/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          elif [ -e "${_DRUSH_CLI_CTRL}/php81.info" ] \
            && [ -x "/opt/php81/bin/php" ]; then
            DRUSH_PHP="/opt/php81/bin/php"
            PHP_INI="/opt/php81/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          elif [ -e "${_DRUSH_CLI_CTRL}/php80.info" ] \
            && [ -x "/opt/php80/bin/php" ]; then
            DRUSH_PHP="/opt/php80/bin/php"
            PHP_INI="/opt/php80/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          elif [ -e "${_DRUSH_CLI_CTRL}/php74.info" ] \
            && [ -x "/opt/php74/bin/php" ]; then
            DRUSH_PHP="/opt/php74/bin/php"
            PHP_INI="/opt/php74/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          elif [ -e "${_DRUSH_CLI_CTRL}/php73.info" ] \
            && [ -x "/opt/php73/bin/php" ]; then
            DRUSH_PHP="/opt/php73/bin/php"
            PHP_INI="/opt/php73/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          elif [ -e "${_DRUSH_CLI_CTRL}/php72.info" ] \
            && [ -x "/opt/php72/bin/php" ]; then
            DRUSH_PHP="/opt/php72/bin/php"
            PHP_INI="/opt/php72/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          elif [ -e "${_DRUSH_CLI_CTRL}/php71.info" ] \
            && [ -x "/opt/php71/bin/php" ]; then
            DRUSH_PHP="/opt/php71/bin/php"
            PHP_INI="/opt/php71/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          elif [ -e "${_DRUSH_CLI_CTRL}/php70.info" ] \
            && [ -x "/opt/php70/bin/php" ]; then
            DRUSH_PHP="/opt/php70/bin/php"
            PHP_INI="/opt/php70/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          elif [ -e "${_DRUSH_CLI_CTRL}/php56.info" ] \
            && [ -x "/opt/php56/bin/php" ]; then
            DRUSH_PHP="/opt/php56/bin/php"
            PHP_INI="/opt/php56/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          fi
        elif [[ "${_ALL}" =~ "drush12-bin " ]]; then
          _DEST_DRUSH="/usr/bin/drush12-bin"
          if [ -e "${_DRUSH_CLI_CTRL}/php82.info" ] \
            && [ -x "/opt/php82/bin/php" ]; then
            DRUSH_PHP="/opt/php82/bin/php"
            PHP_INI="/opt/php82/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          elif [ -e "${_DRUSH_CLI_CTRL}/php81.info" ] \
            && [ -x "/opt/php81/bin/php" ]; then
            DRUSH_PHP="/opt/php81/bin/php"
            PHP_INI="/opt/php81/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          else
            if [ -d "${_DRUSH_CLI_CTRL}" ]; then
              echo
              echo "  Drush 12 requires either PHP 8.1 or 8.2"
              echo "  Please create empty control file:"
              echo
              echo "  ${_DRUSH_CLI_CTRL}/php81.info"
              echo "  or"
              echo "  ${_DRUSH_CLI_CTRL}/php82.info"
              echo
              echo "  NOTE: If you create more than one,"
              echo "        the highest version wins."
              echo "  Bye"
              echo
              exit 0
            fi
          fi
        elif [[ "${_ALL}" =~ "drush11-bin " ]] \
          || [[ "${_ALL}" =~ "drush10-bin " ]]; then
          if [[ "${_ALL}" =~ "drush11-bin " ]]; then
            _DEST_DRUSH="/usr/bin/drush11-bin"
          elif [[ "${_ALL}" =~ "drush10-bin " ]]; then
            _DEST_DRUSH="/usr/bin/drush10-bin"
          fi
          if [ -e "${_DRUSH_CLI_CTRL}/php82.info" ] \
            && [ -x "/opt/php82/bin/php" ]; then
            DRUSH_PHP="/opt/php82/bin/php"
            PHP_INI="/opt/php82/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          elif [ -e "${_DRUSH_CLI_CTRL}/php81.info" ] \
            && [ -x "/opt/php81/bin/php" ]; then
            DRUSH_PHP="/opt/php81/bin/php"
            PHP_INI="/opt/php81/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          elif [ -e "${_DRUSH_CLI_CTRL}/php80.info" ] \
            && [ -x "/opt/php80/bin/php" ]; then
            DRUSH_PHP="/opt/php80/bin/php"
            PHP_INI="/opt/php80/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          elif [ -e "${_DRUSH_CLI_CTRL}/php74.info" ] \
            && [ -x "/opt/php74/bin/php" ]; then
            DRUSH_PHP="/opt/php74/bin/php"
            PHP_INI="/opt/php74/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          else
            if [ -d "${_DRUSH_CLI_CTRL}" ]; then
              echo
              echo "  Drush 11 and Drush 10 require at least PHP 7.4"
              echo "  Please create empty control file:"
              echo
              echo "  ${_DRUSH_CLI_CTRL}/php74.info"
              echo "  or"
              echo "  ${_DRUSH_CLI_CTRL}/php81.info"
              echo "  or"
              echo "  ${_DRUSH_CLI_CTRL}/php82.info"
              echo
              echo "  NOTE: If you create more than one,"
              echo "        the highest version wins."
              echo "  Bye"
              echo
              exit 0
            fi
          fi
        else
          _DEST_DRUSH="/opt/tools/drush/8/drush/drush.php"
          if [ -e "${_DRUSH_CLI_CTRL}/php82.info" ] \
            && [ -x "/opt/php82/bin/php" ]; then
            DRUSH_PHP="/opt/php82/bin/php"
            PHP_INI="/opt/php82/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          elif [ -e "${_DRUSH_CLI_CTRL}/php81.info" ] \
            && [ -x "/opt/php81/bin/php" ]; then
            DRUSH_PHP="/opt/php81/bin/php"
            PHP_INI="/opt/php81/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          elif [ -e "${_DRUSH_CLI_CTRL}/php80.info" ] \
            && [ -x "/opt/php80/bin/php" ]; then
            DRUSH_PHP="/opt/php80/bin/php"
            PHP_INI="/opt/php80/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          elif [ -e "${_DRUSH_CLI_CTRL}/php74.info" ] \
            && [ -x "/opt/php74/bin/php" ]; then
            DRUSH_PHP="/opt/php74/bin/php"
            PHP_INI="/opt/php74/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          elif [ -e "${_DRUSH_CLI_CTRL}/php73.info" ] \
            && [ -x "/opt/php73/bin/php" ]; then
            DRUSH_PHP="/opt/php73/bin/php"
            PHP_INI="/opt/php73/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          elif [ -e "${_DRUSH_CLI_CTRL}/php72.info" ] \
            && [ -x "/opt/php72/bin/php" ]; then
            DRUSH_PHP="/opt/php72/bin/php"
            PHP_INI="/opt/php72/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          elif [ -e "${_DRUSH_CLI_CTRL}/php71.info" ] \
            && [ -x "/opt/php71/bin/php" ]; then
            DRUSH_PHP="/opt/php71/bin/php"
            PHP_INI="/opt/php71/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          elif [ -e "${_DRUSH_CLI_CTRL}/php70.info" ] \
            && [ -x "/opt/php70/bin/php" ]; then
            DRUSH_PHP="/opt/php70/bin/php"
            PHP_INI="/opt/php70/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          elif [ -e "${_DRUSH_CLI_CTRL}/php56.info" ] \
            && [ -x "/opt/php56/bin/php" ]; then
            DRUSH_PHP="/opt/php56/bin/php"
            PHP_INI="/opt/php56/lib/php.ini"
            export DRUSH_PHP;export PHP_INI;
          fi
        fi
        if [[ "${2}" =~ "debug-pm-update" ]]; then
          DRUSH_PHP=""
          _PHP_DEFAULT=$(/usr/bin/php-cli -v | grep 'PHP 7' \
            | cut -d: -f1 | awk '{ print $2}' 2>&1)
          if [ -z "${_PHP_DEFAULT}" ]; then
            _PHP_DEFAULT=$(/usr/bin/php-cli -v | grep 'PHP 5' \
              | cut -d: -f1 | awk '{ print $2}' 2>&1)
          fi
          if [ -z "${_PHP_DEFAULT}" ]; then
            _PHP_DEFAULT=$(/usr/bin/php-cli -v | grep 'PHP 8' \
              | cut -d: -f1 | awk '{ print $2}' 2>&1)
          fi
          if [[ "${_PHP_DEFAULT}" =~ "8.2." ]]; then
            PHP_INI="/opt/php82/lib/php.ini"
          elif [[ "${_PHP_DEFAULT}" =~ "8.1." ]]; then
            PHP_INI="/opt/php81/lib/php.ini"
          elif [[ "${_PHP_DEFAULT}" =~ "8.0." ]]; then
            PHP_INI="/opt/php80/lib/php.ini"
          elif [[ "${_PHP_DEFAULT}" =~ "7.4." ]]; then
            PHP_INI="/opt/php74/lib/php.ini"
          elif [[ "${_PHP_DEFAULT}" =~ "7.3." ]]; then
            PHP_INI="/opt/php73/lib/php.ini"
          elif [[ "${_PHP_DEFAULT}" =~ "7.2." ]]; then
            PHP_INI="/opt/php72/lib/php.ini"
          elif [[ "${_PHP_DEFAULT}" =~ "7.1." ]]; then
            PHP_INI="/opt/php71/lib/php.ini"
          elif [[ "${_PHP_DEFAULT}" =~ "7.0." ]]; then
            PHP_INI="/opt/php70/lib/php.ini"
          elif [[ "${_PHP_DEFAULT}" =~ "5.6." ]]; then
            PHP_INI="/opt/php56/lib/php.ini"
          fi
          export PHP_INI;
        fi
        ### echo 1 DRUSH_PHP is ${DRUSH_PHP}
        ### echo 1 PHP_INI is ${PHP_INI}
        if [[ "${_ALL}" =~ "drush make" ]] \
          || [[ "${_ALL}" =~ "drush8 make" ]] \
          || [[ "${_ALL}" =~ "drush cc drush" ]] \
          || [[ "${_ALL}" =~ "drush8 cc drush" ]] \
          || [[ "${_ALL}" =~ "drush10-bin cc drush" ]] \
          || [[ "${_ALL}" =~ "drush11-bin cc drush" ]] \
          || [[ "${_ALL}" =~ "drush12-bin cc drush" ]] \
          || [[ "${_ALL}" =~ "drushlr cc drush" ]]; then
          if [[ "${_PWD}" =~ "/static" ]] \
            || [[ "${_ALL}" =~ "drush cc drush" ]] \
            || [[ "${_ALL}" =~ "drush8 cc drush" ]] \
            || [[ "${_ALL}" =~ "drush10-bin cc drush" ]] \
            || [[ "${_ALL}" =~ "drush11-bin cc drush" ]] \
            || [[ "${_ALL}" =~ "drush12-bin cc drush" ]] \
            || [[ "${_ALL}" =~ "drushlr cc drush" ]]; then
            _CORRECT=YES
          else
            if [[ "${_ALL}" =~ "make-generate" ]] \
              && [ -f "${_PWD}/settings.php" ]; then
              _CORRECT=YES
            else
              echo
              echo " This drush command can not be run in ${_PWD}"
              if [[ "${2}" =~ "make-generate" ]]; then
                echo " Please cd to the valid sites/foo.com directory first"
                echo " or use a valid @alias, like: drush @foo.com status"
                echo " Hint: Use 'drush aliases' to display all aliases"
              else
                echo " Please cd ~/static first"
              fi
              echo
              exit 0
            fi
          fi
        else
          if [[ "${_ALL}" =~ "drush @" ]] \
            || [[ "${_ALL}" =~ "drush8 @" ]] \
            || [[ "${_ALL}" =~ "drush10-bin @" ]] \
            || [[ "${_ALL}" =~ "drush11-bin @" ]] \
            || [[ "${_ALL}" =~ "drush12-bin @" ]] \
            || [[ "${_ALL}" =~ "drush.launcher @" ]] \
            || [[ "${_ALL}" =~ "drushlr @" ]]; then
            if [[ "${2}" =~ "restore"($) ]] \
              || [[ "${2}" =~ "arr"($) ]] \
              || [[ "${2}" =~ "cli"($) ]] \
              || [[ "${2}" =~ "conf"($) ]] \
              || [[ "${2}" =~ "config"($) ]] \
              || [[ "${2}" =~ "execute"($) ]] \
              || [[ "${2}" =~ "core-quick-drupal"($) ]] \
              || [[ "${2}" =~ "exec"($) ]] \
              || [[ "${2}" =~ "xstatus"($) ]] \
              || [[ "${2}" =~ "redis-flush"($) ]] \
              || [[ "${2}" =~ (^)"qd"($) ]] \
              || [[ "${2}" =~ (^)"rs"($) ]] \
              || [[ "${2}" =~ "runserver"($) ]] \
              || [[ "${2}" =~ (^)"scr"($) ]] \
              || [[ "${2}" =~ (^)"sha"($) ]] \
              || [[ "${2}" =~ "shell-alias"($) ]] \
              || [[ "${2}" =~ (^)"si"($) ]] \
              || [[ "${2}" =~ "sql-create"($) ]] \
              || [[ "${2}" =~ (^)"ssh"($) ]] \
              || [[ "${2}" =~ (^)"sup"($) ]]; then
              echo
              echo " This drush command is not available (A)"
              echo
              exit 0
            else
              _CORRECT=YES
            fi
          elif [[ "${_ALL}" =~ "cc drush" ]] \
            || [[ "${_ALL}" =~ "-c set -m; drush8 --version" ]] \
            || [[ "${_ALL}" =~ "-c set -m; drush8 help" ]] \
            || [[ "${_ALL}" =~ "drush8 dl" ]] \
            || [[ "${_ALL}" =~ "drush8 pm-download" ]] \
            || [[ "${_ALL}" =~ "drush8 sa" ]] \
            || [[ "${_ALL}" =~ "drush8 site-alias" ]] \
            || [[ "${_ALL}" =~ "-c set -m; drush10-bin --version" ]] \
            || [[ "${_ALL}" =~ "-c set -m; drush10-bin help" ]] \
            || [[ "${_ALL}" =~ "drush10-bin dl" ]] \
            || [[ "${_ALL}" =~ "drush10-bin pm-download" ]] \
            || [[ "${_ALL}" =~ "drush10-bin sa" ]] \
            || [[ "${_ALL}" =~ "drush10-bin site-alias" ]] \
            || [[ "${_ALL}" =~ "-c set -m; drush11-bin --version" ]] \
            || [[ "${_ALL}" =~ "-c set -m; drush11-bin help" ]] \
            || [[ "${_ALL}" =~ "drush11-bin dl" ]] \
            || [[ "${_ALL}" =~ "drush11-bin pm-download" ]] \
            || [[ "${_ALL}" =~ "drush11-bin sa" ]] \
            || [[ "${_ALL}" =~ "drush11-bin site-alias" ]] \
            || [[ "${_ALL}" =~ "-c set -m; drush12-bin --version" ]] \
            || [[ "${_ALL}" =~ "-c set -m; drush12-bin help" ]] \
            || [[ "${_ALL}" =~ "drush12-bin dl" ]] \
            || [[ "${_ALL}" =~ "drush12-bin pm-download" ]] \
            || [[ "${_ALL}" =~ "drush12-bin sa" ]] \
            || [[ "${_ALL}" =~ "drush12-bin site-alias" ]] \
            || [[ "${_ALL}" =~ "-c set -m; drushlr --version" ]] \
            || [[ "${_ALL}" =~ "-c set -m; drushlr help" ]] \
            || [[ "${_ALL}" =~ "drushlr dl" ]] \
            || [[ "${_ALL}" =~ "drushlr pm-download" ]] \
            || [[ "${_ALL}" =~ "drushlr sa" ]] \
            || [[ "${_ALL}" =~ "drushlr site-alias" ]] \
            || [[ "${_ALL}" =~ "-c set -m; drush --version" ]] \
            || [[ "${_ALL}" =~ "-c set -m; drush help" ]] \
            || [[ "${_ALL}" =~ "drush dl" ]] \
            || [[ "${_ALL}" =~ "drush pm-download" ]] \
            || [[ "${_ALL}" =~ "drush sa" ]] \
            || [[ "${_ALL}" =~ "drush site-alias" ]]; then
            _CORRECT=YES
          else
            if [[ "${_ALL}" =~ "-c set -m; drush" ]] \
              && [ ! -f "${_PWD}/settings.php" ]; then
              echo
              echo " This drush command can not be run in ${_PWD}"
              echo " Please cd to the valid sites/foo.com directory first"
              echo " or use a valid @alias, like: drush @foo.com status"
              echo " Hint: Use 'drush aliases' to display all aliases"
              echo
              exit 0
            elif [ -f "${_PWD}/settings.php" ]; then
              if [[ "${_ALL}" =~ "drush " ]] \
                || [[ "${_ALL}" =~ "drush8 " ]] \
                || [[ "${_ALL}" =~ "drushlr " ]] \
                || [[ "${_ALL}" =~ "drush.launcher " ]] \
                || [[ "${_ALL}" =~ "drush10-bin " ]] \
                || [[ "${_ALL}" =~ "drush11-bin " ]] \
                || [[ "${_ALL}" =~ "drush12-bin " ]]; then
                _CORRECT=YES
              fi
            fi
          fi
        fi
      fi
    else
      if [[ "${_ALL}" =~ "drush @" ]] \
        || [[ "${_ALL}" =~ "drush8 @" ]] \
        || [[ "${_ALL}" =~ "drush10-bin @" ]] \
        || [[ "${_ALL}" =~ "drush11-bin @" ]] \
        || [[ "${_ALL}" =~ "drush12-bin @" ]] \
        || [[ "${_ALL}" =~ "drush.launcher @" ]] \
        || [[ "${_ALL}" =~ "drushlr @" ]]; then
        if [[ "${2}" =~ "restore"($) ]] \
          || [[ "${2}" =~ "arr"($) ]] \
          || [[ "${2}" =~ "cli"($) ]] \
          || [[ "${2}" =~ "conf"($) ]] \
          || [[ "${2}" =~ "config"($) ]] \
          || [[ "${2}" =~ "execute"($) ]] \
          || [[ "${2}" =~ "core-quick-drupal"($) ]] \
          || [[ "${2}" =~ "exec"($) ]] \
          || [[ "${2}" =~ "xstatus"($) ]] \
          || [[ "${2}" =~ "redis-flush"($) ]] \
          || [[ "${2}" =~ (^)"qd"($) ]] \
          || [[ "${2}" =~ (^)"rs"($) ]] \
          || [[ "${2}" =~ "runserver"($) ]] \
          || [[ "${2}" =~ (^)"scr"($) ]] \
          || [[ "${2}" =~ (^)"sha"($) ]] \
          || [[ "${2}" =~ "shell-alias"($) ]] \
          || [[ "${2}" =~ (^)"si"($) ]] \
          || [[ "${2}" =~ "sql-create"($) ]] \
          || [[ "${2}" =~ (^)"ssh"($) ]] \
          || [[ "${2}" =~ (^)"sup"($) ]]; then
          echo
          echo " This drush command is not available (B)"
          echo
          exit 0
        fi
      fi
      _RAW_IN_PATH=${2//[^a-z/]/}
      if [[ "${2}" =~ (^)"/usr/" ]] \
        || [[ "${2}" =~ (^)"/bin/" ]] \
        || [[ "${2}" =~ (^)"/opt/" ]]; then
        _IN_PATH=YES
      elif [[ "${2}" =~ (^)"/data/disk/${_Y_USR}/tools/drush/drush.php" ]]; then
        _IN_PATH=YES
      elif [[ "${2}" =~ (^)"(/data/disk/${_Y_USR}/tools/drush/drush.php" ]]; then
        _IN_PATH=YES
      elif [[ "${2}" =~ (^)"/var/${_Y_USR}/drush/drush.php" ]]; then
        _IN_PATH=YES
      elif [[ "${2}" =~ (^)"(/var/${_Y_USR}/drush/drush.php" ]]; then
        _IN_PATH=YES
      elif [[ "${_RAW_IN_PATH}" =~ "/usr/bin/wkhtmltopdf" ]]; then
        _IN_PATH=YES
      elif [[ "${_RAW_IN_PATH}" =~ "/usr/bin/wkhtmltoimage" ]]; then
        _IN_PATH=YES
      elif [[ "${_RAW_IN_PATH}" =~ "/usr/local/bin/wkhtmltopdf" ]]; then
        _IN_PATH=YES
      elif [[ "${_RAW_IN_PATH}" =~ "/usr/local/bin/wkhtmltoimage" ]]; then
        _IN_PATH=YES
      elif [[ "${_RAW_IN_PATH}" =~ "/usr/bin/wkhtmltopdf-0.12.4" ]]; then
        _IN_PATH=YES
      elif [[ "${_RAW_IN_PATH}" =~ "/usr/bin/wkhtmltoimage-0.12.4" ]]; then
        _IN_PATH=YES
      elif [[ "${_RAW_IN_PATH}" =~ "/usr/local/bin/composer" ]]; then
        _IN_PATH=YES
      elif [[ "${_RAW_IN_PATH}" =~ "/usr/bin/composer" ]]; then
        _IN_PATH=YES
      elif [[ "${_RAW_IN_PATH}" =~ "/usr/bin/unzip" ]]; then
        _IN_PATH=YES
      elif [[ "${_RAW_IN_PATH}" =~ "/usr/bin/convert" ]]; then
        _IN_PATH=YES
      elif [[ "${_RAW_IN_PATH}" =~ "/usr/bin/gs" ]]; then
        _IN_PATH=YES
      elif [[ "${2}" =~ (^)"/home/" ]] \
        || [[ "${2}" =~ (^)"/data/" ]] \
        || [[ "${2}" =~ (^)"/tmp/" ]]; then
        if [ -e "${2}" ]; then
          _IN_PATH=NO
        fi
      else
        _WHICH_TEST=$(which $2 2>&1)
        if [[ "${_WHICH_TEST}" =~ (^)"/usr/" ]] \
          || [[ "${_WHICH_TEST}" =~ (^)"/bin/" ]] \
          || [[ "${_WHICH_TEST}" =~ (^)"/opt/" ]]; then
          _IN_PATH=YES
        else
          _IN_PATH=NO
        fi
      fi
    fi
  else
    if [[ "${_ALL}" =~ "drush @" ]] \
      || [[ "${_ALL}" =~ "drush8 @" ]] \
      || [[ "${_ALL}" =~ "drush10-bin @" ]] \
      || [[ "${_ALL}" =~ "drush11-bin @" ]] \
      || [[ "${_ALL}" =~ "drush12-bin @" ]] \
      || [[ "${_ALL}" =~ "drush.launcher @" ]] \
      || [[ "${_ALL}" =~ "drushlr @" ]]; then
      if [[ "${2}" =~ "restore"($) ]] \
        || [[ "${2}" =~ "arr"($) ]] \
        || [[ "${2}" =~ "cli"($) ]] \
        || [[ "${2}" =~ "conf"($) ]] \
        || [[ "${2}" =~ "config"($) ]] \
        || [[ "${2}" =~ "execute"($) ]] \
        || [[ "${2}" =~ "core-quick-drupal"($) ]] \
        || [[ "${2}" =~ "exec"($) ]] \
        || [[ "${2}" =~ "xstatus"($) ]] \
        || [[ "${2}" =~ "redis-flush"($) ]] \
        || [[ "${2}" =~ (^)"qd"($) ]] \
        || [[ "${2}" =~ (^)"rs"($) ]] \
        || [[ "${2}" =~ "runserver"($) ]] \
        || [[ "${2}" =~ (^)"scr"($) ]] \
        || [[ "${2}" =~ (^)"sha"($) ]] \
        || [[ "${2}" =~ "shell-alias"($) ]] \
        || [[ "${2}" =~ (^)"si"($) ]] \
        || [[ "${2}" =~ "sql-create"($) ]] \
        || [[ "${2}" =~ (^)"ssh"($) ]] \
        || [[ "${2}" =~ (^)"sup"($) ]]; then
        echo
        echo " This drush command is not available (C)"
        echo
        exit 0
      fi
    fi
    if [[ "$1" =~ (^)"/usr/" ]] \
      || [[ "$1" =~ (^)"/bin/" ]] \
      || [[ "$1" =~ (^)"/opt/" ]]; then
      _IN_PATH=YES
    elif [[ "$1" =~ (^)"/data/disk/${_Y_USR}/tools/drush/drush.php" ]]; then
      _IN_PATH=YES
    elif [[ "$1" =~ (^)"(/data/disk/${_Y_USR}/tools/drush/drush.php" ]]; then
      _IN_PATH=YES
    elif [[ "$1" =~ (^)"/var/${_Y_USR}/drush/drush.php" ]]; then
      _IN_PATH=YES
    elif [[ "$1" =~ (^)"(/var/${_Y_USR}/drush/drush.php" ]]; then
      _IN_PATH=YES
    elif [[ "$1" =~ (^)"/home/" ]] \
      || [[ "$1" =~ (^)"/data/" ]] \
      || [[ "$1" =~ (^)"/tmp/" ]]; then
      if [ -e "$1" ]; then
        _IN_PATH=NO
      fi
    else
      _WHICH_TEST=$(which $1 2>&1)
      if [[ "${_WHICH_TEST}" =~ (^)"/usr/" ]] \
        || [[ "${_WHICH_TEST}" =~ (^)"/bin/" ]] \
        || [[ "${_WHICH_TEST}" =~ (^)"/opt/" ]]; then
        _IN_PATH=YES
      else
        _IN_PATH=NO
      fi
    fi
  fi
  if [[ "${_LTD_GID}" =~ "lshellg"($) ]] \
    || [[ "${_LTD_GID}" =~ "lshellg rvm"($) ]] \
    || [[ "${_LTD_GID}" =~ "ltd-shell"($) ]] \
    || [[ "${_LTD_GID}" =~ "rvm ltd-shell"($) ]] \
    || [[ "${_LTD_GID}" =~ "ltd-shell rvm"($) ]]; then
    if [[ "${_ALL}" =~ "*" ]]; then
      if [[ "${_ALL}" =~ "-c set -m; " ]]; then
        _SILENT=YES
      else
        if [[ "${_ALL}" =~ "__build__" ]] \
          || [[ "${_ALL}" =~ "_tmp_" ]] \
          || [[ "${_ALL}" =~ ".tmp" ]] \
          || [[ "${_ALL}" =~ "avconv" ]] \
          || [[ "${_ALL}" =~ "bzr " ]] \
          || [[ "${_ALL}" =~ "chdir " ]] \
          || [[ "${_ALL}" =~ "compass " ]] \
          || [[ "${_ALL}" =~ "composer " ]] \
          || [[ "${_ALL}" =~ "convert " ]] \
          || [[ "${_ALL}" =~ "curl " ]] \
          || [[ "${_ALL}" =~ "drush" ]] \
          || [[ "${_ALL}" =~ "ffmpeg " ]] \
          || [[ "${_ALL}" =~ "flvtool " ]] \
          || [[ "${_ALL}" =~ "git " ]] \
          || [[ "${_ALL}" =~ "is_" ]] \
          || [[ "${_ALL}" =~ "java" ]] \
          || [[ "${_ALL}" =~ "logger " ]] \
          || [[ "${_ALL}" =~ "php " ]] \
          || [[ "${_ALL}" =~ "unzip " ]] \
          || [[ "${_ALL}" =~ "rename " ]] \
          || [[ "${_ALL}" =~ "rrdtool " ]] \
          || [[ "${_ALL}" =~ "rsync " ]] \
          || [[ "${_ALL}" =~ "sass " ]] \
          || [[ "${_ALL}" =~ "scp " ]] \
          || [[ "${_ALL}" =~ "scss " ]] \
          || [[ "${_ALL}" =~ "sendmail " ]] \
          || [[ "${_ALL}" =~ "ssh " ]] \
          || [[ "${_ALL}" =~ "svn " ]] \
          || [[ "${_ALL}" =~ "tar " ]] \
          || [[ "${_ALL}" =~ "wget " ]] \
          || [[ "${_ALL}" =~ "wkhtmltoimage" ]] \
          || [[ "${_ALL}" =~ "wkhtmltopdf" ]]; then
          _SILENT=YES
        else
          echo
        fi
      fi
    fi
  fi
  if [ "${_IN_PATH}" = "YES" ]; then
    if [ -x "/home/${USER}/.rvm/bin/rvm" ]; then
      if [[ "${_ALL}" =~ "-c set -m; " ]] || [ ! -z "${SSH_CLIENT}" ]; then
        _RUBY_ALLOW=YES
      fi
    fi
    if [ "${_RUBY_ALLOW}" = "YES" ]; then
      _THIS_RV=$(lsb_release -sc 2>&1)
      if [ "${_THIS_RV}" = "chimaera" ] \
        || [ "${_THIS_RV}" = "beowulf" ] \
        || [ "${_THIS_RV}" = "bullseye" ] \
        || [ "${_THIS_RV}" = "buster" ] \
        || [ "${_THIS_RV}" = "stretch" ] \
        || [ "${_THIS_RV}" = "jessie" ] \
        || [ "${_THIS_RV}" = "trusty" ] \
        || [ "${_THIS_RV}" = "precise" ]; then
        _DETECTED_RUBY_VP=$(grep 'RUBY_VERSION' \
          /home/${USER}/.rvm/environments/default \
          | cut -d= -f2 \
          | awk '{ print $1}' \
          | sed "s/'//g" \
          | sed "s/ruby-//g" 2>&1)
        if [ ! -z "${_DETECTED_RUBY_VP}" ] \
          && [ -e "/home/${USER}/.rvm/gems/ruby-${_DETECTED_RUBY_VP}" ]; then
          _RUBY_VP="${_DETECTED_RUBY_VP}"
        else
          _RUBY_VP=3.1.2
        fi
      else
        _DETECTED_RUBY_VP=$(grep 'RUBY_VERSION' \
          /home/${USER}/.rvm/environments/default \
          | cut -d= -f2 \
          | awk '{ print $1}' \
          | sed "s/'//g" \
          | sed "s/ruby-//g" 2>&1)
        if [ ! -z "${_DETECTED_RUBY_VP}" ] \
          && [ -e "/home/${USER}/.rvm/gems/ruby-${_DETECTED_RUBY_VP}" ]; then
          _RUBY_VP="${_DETECTED_RUBY_VP}"
        else
          _RUBY_VP=2.0.0-p648
        fi
      fi
      _SP_A="/home/${USER}/.rvm/gems/ruby-${_RUBY_VP}/bin"
      _SP_B="/home/${USER}/.rvm/gems/ruby-${_RUBY_VP}@global/bin"
      _SP_C="/home/${USER}/.rvm/rubies/ruby-${_RUBY_VP}/bin"
      _SP_D="/home/${USER}/.rvm/bin"
      export PATH="${_SP_A}:${_SP_B}:${_SP_C}:${_SP_D}:${PATH}"
      export GEM_HOME="/home/${USER}/.rvm/gems/ruby-${_RUBY_VP}"
      _GP_A="/home/${USER}/.rvm/gems/ruby-${_RUBY_VP}"
      _GP_B="/home/${USER}/.rvm/gems/ruby-${_RUBY_VP}@global"
      export GEM_PATH="${_GP_A}:${_GP_B}"
      export MY_RUBY_HOME="/home/${USER}/.rvm/rubies/ruby-${_RUBY_VP}"
      export IRBRC="/home/${USER}/.rvm/rubies/ruby-${_RUBY_VP}/.irbrc"
      unset MAGLEV_HOME
      unset RBXOPT
      export RUBY_VERSION="ruby-${_RUBY_VP}"
    fi
    if [ -x "/usr/bin/npm" ] && [ -d "/home/${USER}/.npm-packages" ]; then
      if [[ "${_ALL}" =~ "-c set -m; " ]] || [ ! -z "${SSH_CLIENT}" ]; then
        _NPM_ALLOW=YES
      fi
    fi
    if [ "${_NPM_ALLOW}" = "YES" ]; then
      export NPM_PACKAGES="/home/${USER}/.npm-packages"
      export PATH="${NPM_PACKAGES}/bin:${PATH}"
      export NODE_PATH="${NPM_PACKAGES}/lib/node_modules:${NODE_PATH}"
    fi
    if [ "$0" = "/bin/sh" ] \
      || [ "$0" = "/usr/bin/sh" ] \
      || [ "$0" = "/bin/websh" ]; then
      if [ -x "/bin/dash" ]; then
        if [ ! -z "${_ARR}" ] && [ -z "${_LNCHR_PHP_ARR}" ] && [ -z "${_LNCHR_SH_ARR}" ]; then
          ### echo EXD 1 DRUSH_PHP is ${DRUSH_PHP}
          ### echo EXD 1 PHP_INI is ${PHP_INI}
          ### echo EXD 1 _DEST_DRUSH is ${_DEST_DRUSH}
          ### echo EXD 1 _ARR is ${_ARR}
          export DRUSH_PHP;export PHP_INI;exec ${DRUSH_PHP} ${_DEST_DRUSH} ${_ARR}
          exit 0
        elif [ ! -z "${_LNCHR_PHP_ARR}" ]; then
          ### echo EXD 2 DRUSH_PHP is ${DRUSH_PHP}
          ### echo EXD 2 PHP_INI is ${PHP_INI}
          ### echo EXD 2 _DEST_DRUSH is ${_DEST_DRUSH}
          ### echo EXD 2 _LNCHR_PHP_ARR is ${_LNCHR_PHP_ARR}
          export DRUSH_PHP;export PHP_INI;exec ${DRUSH_PHP} ${_DEST_DRUSH} ${_LNCHR_PHP_ARR}
          exit 0
        elif [ ! -z "${_LNCHR_SH_ARR}" ]; then
          ### echo EXD 3 DRUSH_PHP is ${DRUSH_PHP}
          ### echo EXD 3 PHP_INI is ${PHP_INI}
          ### echo EXD 3 _DEST_DRUSH is ${_DEST_DRUSH}
          ### echo EXD 3 _LNCHR_SH_ARR is ${_LNCHR_SH_ARR}
          export DRUSH_PHP;export PHP_INI;exec ${DRUSH_PHP} ${_DEST_DRUSH} ${_LNCHR_SH_ARR}
          exit 0
        elif [ ! -z "${_C_ARR}" ]; then
          ### echo EXC 1 DRUSH_PHP is ${DRUSH_PHP}
          ### echo EXC 1 _C_ARR is ${_C_ARR}
          ### echo EXC 1 _F_ARR is "$@"
          exec ${DRUSH_PHP} /usr/local/bin/composer "$@"
          exit 0
        else
          ### echo EXH 1 DRUSH_PHP is ${DRUSH_PHP}
          ### echo EXH 1 PHP_INI is ${PHP_INI}
          ### echo EXH 1 _F_ARR is "$@"
          export DRUSH_PHP;export PHP_INI;exec /bin/dash "$@"
          exit 0
        fi
      elif [ -x "/usr/bin/dash" ]; then
        if [ ! -z "${_ARR}" ] && [ -z "${_LNCHR_PHP_ARR}" ] && [ -z "${_LNCHR_SH_ARR}" ]; then
          ### echo EXD 4 DRUSH_PHP is ${DRUSH_PHP}
          ### echo EXD 4 PHP_INI is ${PHP_INI}
          ### echo EXD 4 _DEST_DRUSH is ${_DEST_DRUSH}
          ### echo EXD 4 _ARR is ${_ARR}
          export DRUSH_PHP;export PHP_INI;exec ${DRUSH_PHP} ${_DEST_DRUSH} ${_ARR}
          exit 0
        elif [ ! -z "${_LNCHR_PHP_ARR}" ]; then
          ### echo EXD 5 DRUSH_PHP is ${DRUSH_PHP}
          ### echo EXD 5 PHP_INI is ${PHP_INI}
          ### echo EXD 5 _DEST_DRUSH is ${_DEST_DRUSH}
          ### echo EXD 5 _LNCHR_PHP_ARR is ${_LNCHR_PHP_ARR}
          export DRUSH_PHP;export PHP_INI;exec ${DRUSH_PHP} ${_DEST_DRUSH} ${_LNCHR_PHP_ARR}
          exit 0
        elif [ ! -z "${_LNCHR_SH_ARR}" ]; then
          ### echo EXD 6 DRUSH_PHP is ${DRUSH_PHP}
          ### echo EXD 6 PHP_INI is ${PHP_INI}
          ### echo EXD 6 _DEST_DRUSH is ${_DEST_DRUSH}
          ### echo EXD 6 _LNCHR_SH_ARR is ${_LNCHR_SH_ARR}
          export DRUSH_PHP;export PHP_INI;exec ${DRUSH_PHP} ${_DEST_DRUSH} ${_LNCHR_SH_ARR}
          exit 0
        elif [ ! -z "${_C_ARR}" ]; then
          ### echo EXC 2 DRUSH_PHP is ${DRUSH_PHP}
          ### echo EXC 2 _C_ARR is ${_C_ARR}
          ### echo EXC 2 _F_ARR is "$@"
          exec ${DRUSH_PHP} /usr/local/bin/composer "$@"
          exit 0
        else
          ### echo EXH 2 DRUSH_PHP is ${DRUSH_PHP}
          ### echo EXH 2 PHP_INI is ${PHP_INI}
          ### echo EXH 2 _F_ARR is "$@"
          export DRUSH_PHP;export PHP_INI;exec /usr/bin/dash "$@"
          exit 0
        fi
      else
        if [ ! -z "${_ARR}" ] && [ -z "${_LNCHR_PHP_ARR}" ] && [ -z "${_LNCHR_SH_ARR}" ]; then
          ### echo EXD 7 DRUSH_PHP is ${DRUSH_PHP}
          ### echo EXD 7 PHP_INI is ${PHP_INI}
          ### echo EXD 7 _DEST_DRUSH is ${_DEST_DRUSH}
          ### echo EXD 7 _ARR is ${_ARR}
          export DRUSH_PHP;export PHP_INI;exec ${DRUSH_PHP} ${_DEST_DRUSH} ${_ARR}
          exit 0
        elif [ ! -z "${_LNCHR_PHP_ARR}" ]; then
          ### echo EXD 8 DRUSH_PHP is ${DRUSH_PHP}
          ### echo EXD 8 PHP_INI is ${PHP_INI}
          ### echo EXD 8 _DEST_DRUSH is ${_DEST_DRUSH}
          ### echo EXD 8 _LNCHR_PHP_ARR is ${_LNCHR_PHP_ARR}
          export DRUSH_PHP;export PHP_INI;exec ${DRUSH_PHP} ${_DEST_DRUSH} ${_LNCHR_PHP_ARR}
          exit 0
        elif [ ! -z "${_LNCHR_SH_ARR}" ]; then
          ### echo EXD 9 DRUSH_PHP is ${DRUSH_PHP}
          ### echo EXD 9 PHP_INI is ${PHP_INI}
          ### echo EXD 9 _DEST_DRUSH is ${_DEST_DRUSH}
          ### echo EXD 9 _LNCHR_SH_ARR is ${_LNCHR_SH_ARR}
          export DRUSH_PHP;export PHP_INI;exec ${DRUSH_PHP} ${_DEST_DRUSH} ${_LNCHR_SH_ARR}
          exit 0
        elif [ ! -z "${_C_ARR}" ]; then
          ### echo EXC 3 DRUSH_PHP is ${DRUSH_PHP}
          ### echo EXC 3 _C_ARR is ${_C_ARR}
          ### echo EXC 3 _F_ARR is "$@"
          exec ${DRUSH_PHP} /usr/local/bin/composer "$@"
          exit 0
        else
          ### echo EXH 3 DRUSH_PHP is ${DRUSH_PHP}
          ### echo EXH 3 PHP_INI is ${PHP_INI}
          ### echo EXH 3 _F_ARR is "$@"
          export DRUSH_PHP;export PHP_INI;exec /bin/bash "$@"
          exit 0
        fi
      fi
    else
      if [ ! -z "${_ARR}" ] && [ -z "${_LNCHR_PHP_ARR}" ] && [ -z "${_LNCHR_SH_ARR}" ]; then
        ### echo EXD 10 DRUSH_PHP is ${DRUSH_PHP}
        ### echo EXD 10 PHP_INI is ${PHP_INI}
        ### echo EXD 10 _DEST_DRUSH is ${_DEST_DRUSH}
        ### echo EXD 10 _ARR is ${_ARR}
        export DRUSH_PHP;export PHP_INI;exec ${DRUSH_PHP} ${_DEST_DRUSH} ${_ARR}
        exit 0
      elif [ ! -z "${_LNCHR_PHP_ARR}" ]; then
        ### echo EXD 11 DRUSH_PHP is ${DRUSH_PHP}
        ### echo EXD 11 PHP_INI is ${PHP_INI}
        ### echo EXD 11 _DEST_DRUSH is ${_DEST_DRUSH}
        ### echo EXD 11 _LNCHR_PHP_ARR is ${_LNCHR_PHP_ARR}
        export DRUSH_PHP;export PHP_INI;exec ${DRUSH_PHP} ${_DEST_DRUSH} ${_LNCHR_PHP_ARR}
        exit 0
      elif [ ! -z "${_LNCHR_SH_ARR}" ]; then
        ### echo EXD 12 DRUSH_PHP is ${DRUSH_PHP}
        ### echo EXD 12 PHP_INI is ${PHP_INI}
        ### echo EXD 12 _DEST_DRUSH is ${_DEST_DRUSH}
        ### echo EXD 12 _LNCHR_SH_ARR is ${_LNCHR_SH_ARR}
        export DRUSH_PHP;export PHP_INI;exec ${DRUSH_PHP} ${_DEST_DRUSH} ${_LNCHR_SH_ARR}
        exit 0
      elif [ ! -z "${_C_ARR}" ]; then
        ### echo EXC 4 DRUSH_PHP is ${DRUSH_PHP}
        ### echo EXC 4 _C_ARR is ${_C_ARR}
        ### echo EXC 4 _F_ARR is "$@"
        exec ${DRUSH_PHP} /usr/local/bin/composer "$@"
        exit 0
      else
        ### echo EXO 1 DRUSH_PHP is ${DRUSH_PHP}
        ### echo EXO 1 PHP_INI is ${PHP_INI}
        ### echo EXO 1 _F_ARR is "$@"
        export DRUSH_PHP;export PHP_INI;exec $0 "$@"
        exit 0
      fi
    fi
    exit 0
  else
    exit 1
  fi
else
  if [ "${USER}" = "root" ]; then
    if [[ "$1" =~ "drush" ]] \
      || [[ "${2}" =~ "drush" ]]; then
      if [[ "${2}" =~ "uli" ]] \
        || [[ "${2}" =~ "vget" ]] \
        || [[ "${2}" =~ "config-list" ]] \
        || [[ "${2}" =~ "config-edit" ]] \
        || [[ "${2}" =~ "config-get" ]] \
        || [[ "${2}" =~ "config-set" ]] \
        || [[ "${2}" =~ "--version" ]] \
        || [[ "${2}" =~ "vset" ]] \
        || [[ "${2}" =~ "status" ]]; then
        _ALLOW=YES
      else
        echo
        echo " Drush should never be run as root!"
        echo " Please su to some non-root account"
        echo
        exit 0
      fi
    fi
  fi
  if [ "$0" = "/bin/sh" ] \
    || [ "$0" = "/usr/bin/sh" ] \
    || [ "$0" = "/bin/websh" ]; then
    if [ -x "/bin/dash" ]; then
      ### echo EXH 4 DRUSH_PHP is ${DRUSH_PHP}
      ### echo EXH 4 PHP_INI is ${PHP_INI}
      ### echo EXH 4 _F_ARR is "$@"
      export DRUSH_PHP;export PHP_INI;exec /bin/dash "$@"
      exit 0
    elif [ -x "/usr/bin/dash" ]; then
      ### echo EXH 5 DRUSH_PHP is ${DRUSH_PHP}
      ### echo EXH 5 PHP_INI is ${PHP_INI}
      ### echo EXH 5 _F_ARR is "$@"
      export DRUSH_PHP;export PHP_INI;exec /usr/bin/dash "$@"
      exit 0
    else
      ### echo EXH 6 DRUSH_PHP is ${DRUSH_PHP}
      ### echo EXH 6 PHP_INI is ${PHP_INI}
      ### echo EXH 6 _F_ARR is "$@"
      export DRUSH_PHP;export PHP_INI;exec /bin/bash "$@"
      exit 0
    fi
  else
    ### echo EXO 2 DRUSH_PHP is ${DRUSH_PHP}
    ### echo EXO 2 PHP_INI is ${PHP_INI}
    ### echo EXO 2 _F_ARR is "$@"
    export DRUSH_PHP;export PHP_INI;exec $0 "$@"
    exit 0
  fi
  exit 0
fi
